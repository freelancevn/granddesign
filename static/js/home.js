(function(h,g,l){var k=g.event,j;k.special.smartresize={setup:function(){g(this).bind("resize",k.special.smartresize.handler)},teardown:function(){g(this).unbind("resize",k.special.smartresize.handler)},handler:function(b,n){var m=this,e=arguments;b.type="smartresize",j&&clearTimeout(j),j=setTimeout(function(){g.event.handle.apply(m,e)},n==="execAsap"?0:100)}},g.fn.smartresize=function(b){return b?this.bind("smartresize",b):this.trigger("smartresize",["execAsap"])},g.Mason=function(b,d){this.element=g(d),this._create(b),this._init()},g.Mason.settings={isResizable:!0,isAnimated:!1,animationOptions:{queue:!1,duration:500},gutterWidth:0,isRTL:!1,isFitWidth:!1,containerStyle:{position:"relative"}},g.Mason.prototype={_filterFindBricks:function(d){var c=this.options.itemSelector;return c?d.filter(c).add(d.find(c)):d},_getBricks:function(d){var c=this._filterFindBricks(d).css({position:"absolute"}).addClass("masonry-brick");return c},_create:function(o){this.options=g.extend(!0,{},g.Mason.settings,o),this.styleQueue=[];var n=this.element[0].style;this.originalStyle={height:n.height||""};var m=this.options.containerStyle;for(var b in m){this.originalStyle[b]=n[b]||""}this.element.css(m),this.horizontalDirection=this.options.isRTL?"right":"left",this.offset={x:parseInt(this.element.css("padding-"+this.horizontalDirection),10),y:parseInt(this.element.css("padding-top"),10)},this.isFluid=this.options.columnWidth&&typeof this.options.columnWidth=="function";var a=this;setTimeout(function(){a.element.addClass("masonry")},0),this.options.isResizable&&g(h).bind("smartresize.masonry",function(){a.resize()}),this.reloadItems()},_init:function(b){this._getColumns(),this._reLayout(b)},option:function(b,d){g.isPlainObject(b)&&(this.options=g.extend(!0,this.options,b))},layout:function(u,t){for(var s=0,r=u.length;s<r;s++){this._placeBrick(u[s])}var q={};q.height=Math.max.apply(Math,this.colYs);if(this.options.isFitWidth){var p=0;s=this.cols;while(--s){if(this.colYs[s]!==0){break}p++}q.width=(this.cols-p)*this.columnWidth-this.options.gutterWidth}this.styleQueue.push({$el:this.element,style:q});var o=this.isLaidOut?this.options.isAnimated?"animate":"css":"css",n=this.options.animationOptions,m;for(s=0,r=this.styleQueue.length;s<r;s++){m=this.styleQueue[s],m.$el[o](m.style,n)}this.styleQueue=[],t&&t.call(u),this.isLaidOut=!0},_getColumns:function(){var d=this.options.isFitWidth?this.element.parent():this.element,c=d.width();this.columnWidth=this.isFluid?this.options.columnWidth(c):this.options.columnWidth||this.$bricks.outerWidth(!0)||c,this.columnWidth+=this.options.gutterWidth,this.cols=Math.floor((c+this.options.gutterWidth)/this.columnWidth),this.cols=Math.max(this.cols,1)},_placeBrick:function(B){var A=g(B),z,y,x,w,v;z=Math.ceil(A.outerWidth(!0)/this.columnWidth),z=Math.min(z,this.cols);if(z===1){x=this.colYs}else{y=this.cols+1-z,x=[];for(v=0;v<y;v++){w=this.colYs.slice(v,v+z),x[v]=Math.max.apply(Math,w)}}var u=Math.min.apply(Math,x),t=0;for(var s=0,r=x.length;s<r;s++){if(x[s]===u){t=s;break}}var q={top:u+this.offset.y};q[this.horizontalDirection]=this.columnWidth*t+this.offset.x,this.styleQueue.push({$el:A,style:q});var p=u+A.outerHeight(!0),b=this.cols+1-r;for(s=0;s<b;s++){this.colYs[t+s]=p}},resize:function(){var b=this.cols;this._getColumns(),(this.isFluid||this.cols!==b)&&this._reLayout()},_reLayout:function(d){var c=this.cols;this.colYs=[];while(c--){this.colYs.push(0)}this.layout(this.$bricks,d)},reloadItems:function(){this.$bricks=this._getBricks(this.element.children())},reload:function(b){this.reloadItems(),this._init(b)},appended:function(f,e,n){if(e){this._filterFindBricks(f).css({top:this.element.height()});var m=this;setTimeout(function(){m._appended(f,n)},1)}else{this._appended(f,n)}},_appended:function(e,d){var f=this._getBricks(e);this.$bricks=this.$bricks.add(f),this.layout(f,d)},remove:function(b){this.$bricks=this.$bricks.not(b),b.remove()},destroy:function(){this.$bricks.removeClass("masonry-brick").each(function(){this.style.position="",this.style.top="",this.style.left=""});var b=this.element[0].style;for(var a in this.originalStyle){b[a]=this.originalStyle[a]}this.element.unbind(".masonry").removeClass("masonry").removeData("masonry"),g(h).unbind(".masonry")}},g.fn.imagesLoaded=function(b){function n(){b.call(s,r)}function m(d){var e=d.target;e.src!==p&&g.inArray(e,o)===-1&&(o.push(e),--q<=0&&(setTimeout(n),r.unbind(".imagesLoaded",m)))}var s=this,r=s.find("img").add(s.filter("img")),q=r.length,p="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==",o=[];return q||n(),r.bind("load.imagesLoaded error.imagesLoaded",m).each(function(){var c=this.src;this.src=p,this.src=c}),s};var i=function(a){h.console&&h.console.error(a)};g.fn.masonry=function(b){if(typeof b=="string"){var d=Array.prototype.slice.call(arguments,1);this.each(function(){var a=g.data(this,"masonry");if(!a){i("cannot call methods on masonry prior to initialization; attempted to call method '"+b+"'");return}if(!g.isFunction(a[b])||b.charAt(0)==="_"){i("no such method '"+b+"' for masonry instance");return}a[b].apply(a,d)})}else{this.each(function(){var a=g.data(this,"masonry");a?(a.option(b||{}),a._init()):g.data(this,"masonry",new g.Mason(b,this))})}return this}})(window,jQuery);String.prototype.startsWith=function(a){return this.indexOf(a)==0};Number.prototype.times=function(c,a){var d=Number(this),b=0;if(c!==undefined){if(typeof d==="number"){for(b;b<d;b++){if(typeof a!=="undefined"&&b>0){window.setTimeout(function(){c(b)},a)}else{c(b)}}}}};Array.prototype.contains=function(b){var a=this.length;while(a--){if(this[a]===b){return true}}return false};String.prototype.among=function(a){return a.contains(this.toString())};String.prototype.purge=function(e){e=(typeof e==="string")?[e]:e;var c=". ?".split(" "),b=e.length,a=this,d="";while(b--){d=e[b];if(d.among(c)){d="\\"+d}a=a.replace(new RegExp(d,"g"),"")}return a};String.prototype.cleanse=function(){return this.purge(". : / ? & @ # < > = ,".split(" "))};$.fn.textify=function(){return this.text().replace(/\n/g,"").replace(/\t/g,"")};$.fresca=$.fresca||{};$.fresca.Twitter=function(a){this.element=$(a);this.account="HabitatUK";this.widget="255652160824549376";this.init()};$.fresca.Twitter.prototype={init:function(){var a=this,c=a.element.attr("data-account")||a.account,b=a.element.attr("data-widget")||a.widget;a.element.append('<a class="twitter-timeline" href="https://twitter.com/'+c+'" data-widget-id="'+b+'">Tweets by @'+c+"</a>");a.element.append('<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");<\/script>')}};$.fresca.Video=function(a){this.element=null;this.width=1;this.height=1;this.id="";this.source="";this.init(a)};$.fresca.Video.prototype={setElement:function(a){this.element=$(a)},setDimensions:function(){var a=this;a.width=a.element.innerWidth();a.height=a.element.innerHeight()},setId:function(){var a=this;a.id=a.element.attr("data-video")},setSource:function(){var a=this;a.source="http://www.youtube.com/embed/"+a.id},build:function(){var a=this,b=$('<iframe frameborder="0" allowfullscreen></iframe>').attr({width:a.width,height:a.height,src:a.source});a.element.append(b)},init:function(b){var a=this;a.setElement(b);a.setDimensions();a.setId();a.setSource();a.build()}};$.fresca.Product=function(a){this.element=null;this.products=null;this.response=null;this.size="";this.url="";this.init(a)};$.fresca.Product.prototype={setElement:function(a){this.element=$(a).addClass("product")},setSize:function(){var b=this,c=b.element.attr("class").split(" "),d=1,a=1;$.each(c,function(f,e){if(e.length===2){if(e.startsWith("w")){d=e.purge("w")}if(e.startsWith("h")){a=e.purge("h")}}});if(parseInt(d)===2&&parseInt(a)===2){b.size="large";b.element.addClass("large")}},setUrl:function(){var a=this;a.url="/pws/AJProductDetails.ice?layout=home.product.layout&size="+a.size+"&ProductID="+a.element.attr("data-product").cleanse()},addLoader:function(){this.products.append("<li></li>")},loadProduct:function(){var a=this;$.ajax({url:a.url,success:function(b){a.response=$(b);a.update()}})},build:function(){var a=this,b=a.element;b.append(a.template("framework"));a.products=b.find(".products");a.addLoader()},template:function(a){switch(a){case"framework":return"<h2"+(this.element.attr("title")===""?' class="empty"':"")+">"+(this.element.attr("title")!==""?this.element.attr("title"):"")+'</h2><div class="wrapper"><ul class="products"></ul></div>';break}},format:function(c){var b=$(c),a=b.find(".product_price");b.find("h3 a").append(" "+a.html());a.remove();return b},update:function(){var a=this;a.products.empty();a.products.append(a.format(a.response));if(a.size==="large"){a.element.find(".main_image").attr("width",420).attr("src",a.element.find(".main_image").attr("src").replace("/medium/","/large/"))}},init:function(b){var a=this;a.setElement(b);a.setSize();a.setUrl();a.build();a.loadProduct()}};$.fresca.merchs={init:function(){$("div:not(.slideshow) > label a","#main").closest("div").each(function(){var a=$(this).css("cursor","pointer");var b=a.find("a").attr("href");a.attr("title",a.find("img").attr("alt"));a.click(function(){window.location=b})})}};$.fresca.Carousel=function(a){this.element=null;this.wrapper=null;this.products=null;this.arrows=null;this.response=null;this.width=1;this.height=1;this.productsPerPage=1;this.productWidth=1;this.animateBy=1;this.animating=false;this.url="";this.init(a)};$.fresca.Carousel.prototype={setElement:function(a){this.element=$(a)},setDimensions:function(){var a=this,b=a.element.attr("class").split(" ");$.each(b,function(d,c){if(c.length===2){if(c.startsWith("w")){a.width=c.purge("w")}if(c.startsWith("h")){a.height=c.purge("h")}}})},setProductsPerPage:function(){var a=this;a.productsPerPage=a.width*a.height},setUrl:function(){var a=this,b=a.element.find("a"),c=b.attr("href").replace("://","").split("/");a.url="/pws/AJProductFiltering.ice?layout=carousel.layout&productsPerPage=24&loadCat=true&paId=wc_"+c[2].cleanse()+"&value="+c[1].cleanse()},setProductWidth:function(){var a=this;a.productWidth=a.first.outerWidth(true)},setAnimateBy:function(){var a=this;a.animateBy=-a.productWidth*a.width},setFirstLast:function(c){var a=this,b=a.products.find("li");a.first=a.products.find("li:first");a.firstFew=b.slice(0,a.productsPerPage);a.last=a.products.find("li:last");a.lastFew=b.slice(b.length-a.productsPerPage,b.length);if(c){a.first.addClass("first");a.last.addClass("last")}},addLoader:function(){var a=this;a.productsPerPage.times(function(){a.products.append("<li></li>")})},loadCategory:function(){var a=this;$.ajax({url:a.url,success:function(b){a.response=$(b).filter("li");a.update()}})},build:function(){var a=this,b=a.element;b.append(a.template("framework"));a.wrapper=b.find(".wrapper");a.products=b.find(".products");a.arrows=b.find(".arrow");a.addLoader();a.controls()},template:function(a){switch(a){case"framework":return'<img src="/pws/images/arrow-left.png" class="arrow left" /><div class="wrapper"><ul class="products"></ul></div><img src="/pws/images/arrow-right.png" class="arrow right" />';break}},moveFirstFew:function(){var a=this;a.last.after(a.firstFew);a.products.css("marginLeft",0);a.setFirstLast()},moveLastFew:function(){var a=this;a.first.before(a.lastFew);a.products.css("marginLeft",a.animateBy*2);a.setFirstLast()},format:function(g){var c=$(g),d=c.find(".product_price"),h=d.html(),e=c.find("h3 a > span").textify(),a=e.length-40;if(d.find(".was_price").length>0){h=' <span class="was">was&nbsp;<s>'+d.find(".wasPrice").html()+"</s>";h+='</span>&nbsp;<span class="now">NOW&nbsp;'+d.find(".now_price .price_value").html()+"</span>";a=e.length-30}if(a>2){var f=c.find("h3 a > span:last"),b=f.textify(),i=b.substring(0,b.length-a).trim()+"&hellip;";f.html(i)}c.find("h3 a").append(" "+h.replace(".00","").replace(".00",""));d.remove();return c},update:function(){var a=this;a.products.empty();a.response.each(function(){a.products.append(a.format(this))});a.setFirstLast(true);a.setProductWidth();a.setAnimateBy();a.moveLastFew();a.animate(0)},controls:function(){var a=this;a.arrows.click(function(){if(!a.animating){var b=$(this).attr("class").split(" ")[1];if(b==="right"){a.moveFirstFew()}else{a.moveLastFew()}a.animate()}})},animate:function(b){var a=this;a.animating=true;a.products.animate({marginLeft:a.animateBy},(typeof b!=="undefined"?b:500),function(){a.animating=false})},init:function(b){var a=this;a.setElement(b);a.setDimensions();a.setProductsPerPage();a.setUrl();a.build();a.loadCategory()}};$.fresca.Slideshow=function(b){var h=$(b),i=h.find("ul"),l=h.find("li"),j=$("<ol></ol>").appendTo(h),g=$('<span class="arrow left">left</span><span class="arrow right">right</span>'),e=0,a=i.find("li:first").outerWidth(),d=l.length,k=1,f=500;if(d>1){g.appendTo(h);d.times(function(m){j.append("<li"+(m===0?' class="selected"':"")+">"+(m+1)+"</li>")});if(l.length===2){i.find("li:last").clone().prependTo(i);i.find("li:eq(1)").clone().appendTo(i)}else{i.find("li:last").prependTo(i)}i.css("marginLeft",-a);function c(m){m.addClass("selected").siblings("li").removeClass("selected")}g.click(function(){var m=$(this).fadeOut().fadeIn(),o=m.attr("class").split(" ")[1],n=0;if(o==="right"){e=-a*2;k++;if(k>d){k=1}n=2}else{e=0;k--;if(k===0){k=d}}if(f!==0){$("li",i).eq(n).find("h2").css("marginLeft",(n===0?-400:200)).animate({marginLeft:0},f+100);$("li",i).eq(n).find("label a").css("marginLeft",(n===0?-400:200)).animate({marginLeft:0},f+200)}i.animate({marginLeft:e},f,function(){if(o==="right"){i.find("li:first").appendTo(i)}else{i.find("li:last").prependTo(i)}i.css("marginLeft",-a);c($("li",j).eq(k-1))})});$("li",j).click(function(){var n=$(this).fadeOut().fadeIn(),p=j.find(".selected"),m=p.prevAll("li").length+1,o=n.prevAll("li").length+1,r=o-m,q=g.filter(".right");if(r!==0){if(r<0){q=g.filter(".left");r=-r}f=0;r.times(function(){q.click()});f=500}})}};$(function(){$("[data-video]").each(function(){new $.fresca.Video(this)});$("[data-product]").each(function(){new $.fresca.Product(this)});$.fresca.merchs.init();$(".carousel").each(function(){new $.fresca.Carousel(this)});$(".twitter").each(function(){new $.fresca.Twitter(this)});$(".slideshow").each(function(){new $.fresca.Slideshow(this)})});