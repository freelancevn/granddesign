var btf={saleValidation:function(){var b=$("#trans"),c=$(".sale_validation"),a=$("#buy_button");if(c.length>0){if(!c.hasClass("valid")){b.fadeIn("slow")}else{b.fadeOut("fast");a.click()}}},clickHandlers:function(c){var b=$(".sale_validation"),a=$("#buy_button");$(".close img").on("click",function(){b.addClass("valid");btf.saleValidation()});$(a).on("click",function(d){if(b.length>0){if(!b.hasClass("valid")){d.preventDefault();btf.saleValidation()}else{return true}}else{a.click()}})}};$(function(){btf.clickHandlers()});function addMinus(){var b=$("#value_pd");var a=$("#select_qty_pd");function c(d){b.text(Math.max(parseInt(b.text())+d.data.increment,0));a.val(Math.max(parseInt(a.val())+d.data.increment,0));return false}$("#plus_pd").bind("click",{increment:1},c);$("#minus_pd").bind("click",{increment:-1},c)}function thumbnailsPagination(b){var i=$(".alt_view");d($(".arrow_up",b));var h=3;var f=0;var a=$("ul",b);var c=a.find("li");var g=c.length;i.click(function(){var j=$(this);if(!j.hasClass("disabled")){var l=j.attr("class").split(" ")[1].split("_")[1];var k=$(c[0]).outerHeight();var m=k;if(l==="down"){if(h===(g-1)){h=h+1}else{if(h===(g-2)){m=k*2;h=h+2}else{m=k*3;h=h+3}}f-=m}else{if(h===4){h=h-1}else{if(h===5){m=k*2;h=h-2}else{m=k*3;h=h-3}}f+=m}a.animate({top:f},800);e(i);switch(h){case 3:d($(".arrow_up",b));break;case g:d($(".arrow_down",b));break}}});function d(j){if(!j.hasClass("disabled")){j.addClass("disabled").css("opacity",0.1)}}function e(j){if(j.hasClass("disabled")){j.removeClass("disabled").css("opacity",1)}}}$.fn.handleProductScrolling=function(a){return this.each(function(){var j=$(this).parent("div").attr("id");var c=$("#"+j);var k=$(".tab:visible",c);var o=$(".arrow",c);var n=5;var i=10;if(j=="goes_with_tabs_content"||j=="you_may_also_like_tabs_content"){var n=1;var i=1;var m=410}else{if(j=="available_in_tabs_content"){var n=4;var i=8;var m=90}else{if(j=="product_relations_tabs_content"){var n=1;var i=5;var m=175}else{var m=175}}}var d=n;if(j=="product_relations_tabs_content"){var d=5}else{if(j=="goes_with_tabs_content"||j=="you_may_also_like_tabs_content"){var d=2}}var e=0;var f=$(".relations_products",k);var l=f.find("li");var b=l.length;if(j=="goes_with_tabs_content"||j=="you_may_also_like_tabs_content"){b=Math.ceil(b/4);if(b%4!=0){b++}}if(b>d){o.show();function g(p){if(!p.hasClass("disabled")){p.addClass("disabled").css("opacity",0.1)}}function h(p){if(p.hasClass("disabled")){p.removeClass("disabled").css("opacity",1)}}if(j=="available_in_tabs_content"){f.css("width",b*m)}if(f.data("currentProduct")){d=f.data("currentProduct")}if(f.data("currentProduct")){e=f.data("marginLeft")}if(e===0){g($(".relations_left",c))}if(d===b){g($(".relations_right",c))}else{h($(".relations_right",c))}o.unbind("click").click(function(){var q=$(this);if(!q.hasClass("disabled")){var r=q.attr("class").split(" ")[1].split("_")[1];var p=m;var s=p;if(r==="right"){if(b-d<n){if(j=="goes_with_tabs_content"||j=="you_may_also_like_tabs_content"){s=205}if(j=="product_relations_tabs_content"){s=175}else{s=p*n}d=d+(b-d)}else{if(j=="goes_with_tabs_content"||j=="you_may_also_like_tabs_content"){s=205*n}if(j=="product_relations_tabs_content"){s=175}else{s=p*n}d=d+n}e-=s}else{if(d>n&&d<i){if(j=="goes_with_tabs_content"||j=="you_may_also_like_tabs_content"){s=205}if(j=="product_relations_tabs_content"){s=175}else{s=p*n}d=d-n}else{if(j=="goes_with_tabs_content"||j=="you_may_also_like_tabs_content"){s=205*n}if(j=="product_relations_tabs_content"){s=175}else{s=p*n}d=d-n}e+=s}f.animate({marginLeft:e},350);h(o);switch(d){case n:g($(".relations_left",c));break;case b:g($(".relations_right",c));break}if(e===0){g($(".relations_left",c))}f.data("currentProduct",d);f.data("marginLeft",e)}})}else{o.hide()}})};function loadParentCategory(a){$.ajax({url:a,beforeSend:function(b){},success:function(b,c){extractProducts(b)},error:function(b,d,c){}})}function setupWishlist(){$("span.add_to_wishlist").click(function(){$(".wishlist_selection").slideDown("slow")})}function ApplyScrollPane(a,b){$("ul.tabs li.active").each(function(){var c=$(this);addScrollers(c,a,b)});$("ul.tabs li").click(function(){if(!$(this).hasClass("active")){var d=$(this).attr("class");$(this).parents("div.tabNavigation").find(".active").removeClass("active");$(this).parents("div.tabNavigation").find("div[class="+d+"]").addClass("active");$(this).addClass("active");if(b.hasClass("scrollPane")===true){b.removeClass("scrollPane")}var c=$(this);addScrollers(c,a,b);Cufon.replace("ul.tabs li h3")}})}function addScrollers(d,a,b){var c=$("div#tabsProdInfo div."+$(d).attr("class").split(" ")[0]);if(c.height()>a){b.addClass("scrollPane");b.jScrollPane({scrollbarWidth:8,animateTo:true,autoReinitialise:true});$("div.jScrollPaneContainer").css("width","328px")}}(function(a){a.fn.frescaZoom=function(e){var n=a.extend({},a.fn.frescaZoom.defaults,e);var i=this;var f;var d;var m;var r;var c;var s;function b(){f=a(i);f.wrap('<div id="zoomParent">');i=a("div#zoomParent");var v=f.attr("src").split(n.productFolder);var u=v[0]+n.zoomFolder+v[1];d=a("<img>").attr("src",u).attr("width",n.zoomWidth).attr("height",n.zoomHeight).css("position","absolute");m=a('<div id="zoomCont"></div>');m.append(d);i.after(m);if(g()){a("#main_product_container").append('<span id="zoom_button" class="button type_d"><em class="value">Tap here to zoom&nbsp;in</em></span>');a("#zoom_button").css({position:"absolute",bottom:"20px",left:"20px"})}else{a("#main_product_container").append('<span id="zoom_prompt">Click to zoom</span>')}s=a("#zoomCont");h(v[0]);i.data("active","false");q();p()}function g(){return"ontouchstart" in window}function p(){if(g()){i.add("#zoom_button").bind("touchstart",function(w){if(i.data("active")=="true"){i.data("active","false");a(".value","#zoom_button").html("Tap here to zoom&nbsp;in").parent().next().remove();k()}else{var x;if(a(this).attr("id")==="zoom_button"){var v=f.offset().left+(f.width()/2);var u=f.offset().top+(f.height()/2);x={pageX:v,pageY:u}}else{x=w.originalEvent.touches[0]}l(true);i.data("active","true");t(x);a(".value","#zoom_button").html("Tap here to zoom&nbsp;out").parent().after('<span id="zoom_prompt">Drag to move the image</span>');a("#zoom_prompt").css({bottom:"25px",left:"220px"})}})}else{i.bind("mouseup",function(u){a("div#product_image img#promo_image").hide();if(i.data("active")==="false"){l();i.data("active","true");t(u)}return false});a(s).hover(function(){},function(){k();i.data("active","false");a("div#product_image img#promo_image").show()}).click(function(){if(i.data("active")==="true"){k();i.data("active","false")}})}}function q(){c=n.zoomHeight/f.height();mouseWindowWidth=(m.width()/c);mouseWindowHeight=(m.height()/c)}function t(A){if(c>999&&f.height()>0){q()}var u=f.height();var v=f.width();var x=A.pageY-f.offset().top;var z=A.pageX-f.offset().left;var y=(z-mouseWindowWidth/2);var w=(x-mouseWindowHeight/2);if(y<0){y=0}else{if(y>(v-mouseWindowWidth)){y=v-mouseWindowWidth}}if(w<0){w=0}else{if(w>(u-mouseWindowHeight)){w=u-mouseWindowHeight}}d.css({top:"-"+(w*c)+"px",left:"-"+(y*c)+"px"})}function o(v,z,y){var w=z.clientY-f.offset().top;var x=z.clientX-f.offset().left;var B=v.originalEvent.touches[0].clientY-f.offset().top;var D=v.originalEvent.touches[0].clientX-f.offset().left;var A=B-w;var C=D-x;var E=y.top+A;var u=y.left+C;if(E>0){E=0}else{if(E<-1*(n.zoomHeight-a(m).height())){E=-1*(n.zoomHeight-a(m).height())}}if(u>0){u=0}else{if(u<-1*(n.zoomWidth-a(m).width())){u=-1*(n.zoomWidth-a(m).width())}}d.css({top:E+"px",left:u+"px"})}function j(){a(s).bind("touchend",function(){k();i.data("active","false")})}function l(u){m.css("display","block");a("#zoom_prompt").css("visibility","hidden");if(u){a(s).bind("touchstart",function(z){var x=z.originalEvent.touches[0].clientY;var y=z.originalEvent.touches[0].clientX;var v={clientY:x,clientX:y};var w=d.position();a(s).bind("touchmove",function(A){A.preventDefault();o(A,v,w)})}).bind("touchend",function(){a(s).unbind("touchmove")})}else{a(s).bind("mousemove",function(v){t(v);return false})}}function k(){a(s).unbind("mousemove");m.css("display","none");a("#zoom_prompt").css("visibility","visible")}function h(D){var y=a("img#main_image");var C=1;var w=[];var B=y.attr("alt");var z=y.attr("src").replace("large","thumb");var v=a('<div id="product_views_cont"><div id="product_views"><ul></ul></div></div>');var x;var A=0;while((x=u())){w[C-1]=x;C++}if(w.length>0){a.each(w,function(){v.find("ul").append('<li><img src="'+this+'" alt="'+B+'" /></li>')});if(w.length>3){v.prepend('<span class="arrow arrow_up alt_view">Up</span>').append('<span class="arrow arrow_down alt_view">Down</span>')}a("div#product_image").before(v);thumbnailsPagination(v)}function u(){returnValue=false;if(A<=11){if(C===1){var E=z}else{var E=z.replace(".jpg",("_"+(C-1)+".jpg"))}a.ajax({url:E,type:"HEAD",async:false,error:function(H,F,G){returnValue=false;A++},success:function(){returnValue=E;A++}})}return returnValue}a(n.alternativeViewsElement+" li").each(function(){var H=a(this).find("img").attr("src").split(n.thumbnailFolder);var E=H[H.length-1];var G=D+n.productFolder+E;var F=D+n.zoomFolder+E;a("<img>").attr("src",G);a("<img>").attr("stc",F);a(this).css("cursor","pointer").click(function(){f.attr("src",G);d.attr("src",F)})})}b();return a(this)};a.fn.frescaZoom.defaults={thumbnailFolder:"thumb",productFolder:"large",zoomFolder:"zoom",alternativeViews:true,alternativeViewsElement:"div#product_views",ie6PngFix:false,activateOn:"click",overlayZoom:true,zoomHeight:1200,zoomWidth:1600}})(jQuery);$.fn.loadAssociatedProducts=function(b){var a=0;var c=this.length;return this.each(function(){var m="";var j=$(this).parent("div").attr("class").split("grade_")[1];var e=$(this).attr("id").split("_tabs_content")[0].toUpperCase();var g=$("<div id='loading'><img src='/pws/images/loader.gif' /></div>");var i=$(this).attr("class").split("_type")[0];var k=$(this).attr("class").split("prod_")[1];var h=e+"-"+i;$(this).append(g);if(e=="GOES_WITH"&&goesWithOverride==true){$("div#loading").remove();$(this).children("div.tab").handleProductScrolling();a+=1;if(a>=c){align_GW_Buttons();$.fresca.initPopup()}var f=$(this).find("li.productCont");var l=f.length;var n=Math.ceil(l/2);$(f[n]).addClass("firstNewRow");if(l==0){d($(this),k,h,j,false)}}else{d($(this),k,h,j,false)}});function d(e,j,f,i,h){var g="";if(typeof i!="undefined"){g="&grade="+i}e.load("/pws/AJRelatedProduct.ice?ProductID="+j+"&relationname="+f+g,function(){$("div#loading").remove();Cufon.replace(".ly_group h2",{fontFamily:"DIN Habitat Bold"});Cufon.replace(".ly_minimal h2",{fontFamily:"DIN Habitat Regular"});e.children("div.tab").handleProductScrolling();a+=1;if(a>=c){align_GW_Buttons();$.fresca.initPopup()}var l=e.find("li.productCont");var k=l.length;var m=Math.ceil(k/2);$(l[m]).addClass("firstNewRow");if(k==0){if(g!=""&&!h){d(e,j,f,(parseInt(i)-1),true)}else{e.css("display","none")}}})}};$(document).ready(function(){$("img#main_image").frescaZoom();addMinus();setupWishlist();$("div#product_image img#promo_image").show();ApplyScrollPane(91,$("div#product_info_tabs"));Cufon.replace("ul.tabs li h3");$("div.associated_products").loadAssociatedProducts();$("div.tab").handleProductScrolling();$("div#video a").colorbox();align_Buttons()});function align_Buttons(){var a=0;$("#recently_viewed_products li").each(function(){height=$(this).height();if($(this).children("p").children("span").hasClass(".was_price")){height+=20}if(height>a){a=height}});$("#product_relations_tabs_content .tab").css("height",a);a=0;$("#recently_viewed_products li.productCont div.recent_product_info").each(function(){if($(this).height()>a){a=$(this).height()}});$("#recently_viewed_products li.productCont div.recent_product_info").css("height",a)}function align_GW_Buttons(){var c=0;var d=0;var b=0;lastHeight=0;var a=false;$("#goes_with li.productCont div.product_info").each(function(){height=$(this).height();b+=195;if(a==false){if($(this).parent().hasClass("firstNewRow")){a=true;lastHeight=0;$("#prodListGoesWith").css("width",b+"px")}}if(height>lastHeight){lastHeight=height;if(a==false){c=height}else{d=height}}});$("#goes_with li.productCont div.product_info").css("height",c);$("#goes_with li.firstNewRow").children(".product_info").css("height",d);$("#goes_with li.firstNewRow").nextAll("li.productCont").children(".product_info").css("height",d);align_YMAL_Buttons()}function align_YMAL_Buttons(){var b=0;var c=0;lastHeight=0;var a=false;$("#you_may_also_like li.productCont div.product_info").each(function(){height=$(this).height();if(a==false){if($(this).parent().hasClass("firstNewRow")){a=true;lastHeight=0}}if(height>lastHeight){lastHeight=height;if(a==false){b=height}else{c=height}}});$("#you_may_also_like li.productCont div.product_info").css("height",b);$("#you_may_also_like li.firstNewRow").children(".product_info").css("height",c);$("#you_may_also_like li.firstNewRow").nextAll("li.productCont").children(".product_info").css("height",c)};